#!/usr/bin/env bash

mkdir -p "$1" "$2"
build=$(cd "$1/" && pwd)

function download_and_install_jdk {
  	curl --silent --location http://heroku-jvm-common.s3.amazonaws.com/jvm-buildpack-common.tar.gz | tar xz
	. bin/java
	echo -n "-----> Installing OpenJDK 1.8..."
	install_java ${BUILD_DIR} "1.8"
	echo "done"
}

function download_and_install_groovy {
	cd $1
	echo -n "-----> Installing groovy 2.3.6..."
	curl -L -O -s http://dl.bintray.com/groovy/maven/groovy-binary-2.3.6.zip
	ls -l
	mkdir -p vendor/groovy
	jar xf groovy-binary-2.3.6.zip
	chmod -R +x groovy-2.3.6
	cp -R groovy-2.3.6 vendor/groovy
	echo "done"
}

download_and_install_jdk
download_and_install_groovy

mkdir -p $build/.profile.d
echo 'PATH=$PATH:/app/vendor/groovy/bin' > $build/.profile.d/groovy.sh
